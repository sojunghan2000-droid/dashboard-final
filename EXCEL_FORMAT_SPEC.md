# 엑셀 Report Template 포맷 스펙

## 버전 정보
- **포맷 버전**: 1.0
- **최종 업데이트**: 2025-01-26
- **지원 포맷 버전**: 1.0

---

## 1. 시트 구조

엑셀 파일은 다음 3개의 시트로 구성됩니다:

1. **검사 현황** (Inspection Status)
2. **QR List** (QR Code List)
3. **Reports** (Completed Reports)

---

## 2. 시트별 상세 스펙

### 2.1 검사 현황 시트

#### 시트명
- 한국어: `검사 현황`
- 영어: `Inspection Status`

#### 컬럼 구조

| 순서 | 컬럼명 (한국어) | 컬럼명 (영어) | 타입 | 필수 | 설명 | 예시 |
|------|----------------|--------------|------|------|------|------|
| 1 | PNL NO. | PNL NO. | String | ✅ | 분전반 고유 번호 | `DB-F1-001` |
| 2 | 검사 현황 | Status | String | ✅ | 검사 상태 (`Complete`, `In Progress`, `Pending`) | `Complete` |
| 3 | 점검일 | Inspection Date | String | ✅ | 마지막 점검일 (YYYY-MM-DD HH:mm:ss) | `2025-01-26 14:30:00` |
| 4 | 용접기 | Welder | String | ✅ | 용접기 연결 여부 (`Yes`, `No`) | `Yes` |
| 5 | 연삭기 | Grinder | String | ✅ | 연삭기 연결 여부 (`Yes`, `No`) | `No` |
| 6 | 조명 | Light | String | ✅ | 조명 연결 여부 (`Yes`, `No`) | `Yes` |
| 7 | 펌프 | Pump | String | ✅ | 펌프 연결 여부 (`Yes`, `No`) | `No` |
| 8 | 부하 원인 | Load Cause | String | ✅ | 연결된 부하 목록 (쉼표로 구분) | `Welder, Light` |
| 9 | 점검 조치 사항 | Memo | String | ❌ | 점검 시 조치 사항 메모 | `All connections secure.` |
| 10 | X 좌표 (%) | Position X | String | ❌ | X 좌표 (퍼센트, % 포함) | `25%` |
| 11 | Y 좌표 (%) | Position Y | String | ❌ | Y 좌표 (퍼센트, % 포함) | `30%` |

#### 예시 데이터 (1행)

```
PNL NO. | 검사 현황 | 점검일 | 용접기 | 연삭기 | 조명 | 펌프 | 부하 원인 | 점검 조치 사항 | X 좌표 (%) | Y 좌표 (%)
DB-F1-001 | Complete | 2025-01-26 14:30:00 | Yes | No | Yes | No | Welder, Light | All connections secure. | 25% | 30%
```

---

### 2.2 QR List 시트

#### 시트명
- 한국어: `QR List`
- 영어: `QR List`

#### 컬럼 구조

| 순서 | 컬럼명 (한국어) | 컬럼명 (영어) | 타입 | 필수 | 설명 | 예시 |
|------|----------------|--------------|------|------|------|------|
| 1 | PNL NO. | PNL NO. | String | ✅ | 분전반 고유 번호 | `DB-F1-001` |
| 2 | QR ID | QR ID | String | ✅ | QR 코드 ID | `DB-F1-001` |
| 3 | X 좌표 (%) | Position X | String | ❌ | X 좌표 (퍼센트, % 포함) | `25%` |
| 4 | Y 좌표 (%) | Position Y | String | ❌ | Y 좌표 (퍼센트, % 포함) | `30%` |
| 5 | QR 위치 | QR Location | String | ❌ | QR 코드 위치 정보 | `Building A` |
| 6 | QR 층수 | QR Floor | String | ❌ | QR 코드 층수 정보 | `F1` |
| 7 | QR 위치 정보 | QR Position | String | ❌ | QR 코드 상세 위치 정보 | `Main Hall` |

#### 예시 데이터 (1행)

```
PNL NO. | QR ID | X 좌표 (%) | Y 좌표 (%) | QR 위치 | QR 층수 | QR 위치 정보
DB-F1-001 | DB-F1-001 | 25% | 30% | Building A | F1 | Main Hall
```

---

### 2.3 Reports 시트

#### 시트명
- 한국어: `Reports`
- 영어: `Reports`

#### 컬럼 구조

| 순서 | 컬럼명 (한국어) | 컬럼명 (영어) | 타입 | 필수 | 설명 | 예시 |
|------|----------------|--------------|------|------|------|------|
| 1 | PNL NO. | PNL NO. | String | ✅ | 분전반 고유 번호 | `DB-F1-001` |
| 2 | Report ID | Report ID | String | ✅ | 보고서 고유 ID | `RPT-DB-F1-001-2025-01-26` |
| 3 | 보고서 생성일 | Report Generated At | String | ✅ | 보고서 생성일시 (YYYY-MM-DD HH:mm:ss) | `2025-01-26 15:00:00` |
| 4 | 마지막 점검일 | Last Inspection Date | String | ✅ | 마지막 점검일 (YYYY-MM-DD HH:mm:ss) | `2025-01-26 14:30:00` |
| 5 | 부하 원인 | Load Cause | String | ✅ | 연결된 부하 목록 (쉼표로 구분) | `Welder, Light` |
| 6 | 점검 조치 사항 | Memo | String | ❌ | 점검 시 조치 사항 메모 | `All connections secure.` |

#### 예시 데이터 (1행)

```
PNL NO. | Report ID | 보고서 생성일 | 마지막 점검일 | 부하 원인 | 점검 조치 사항
DB-F1-001 | RPT-DB-F1-001-2025-01-26 | 2025-01-26 15:00:00 | 2025-01-26 14:30:00 | Welder, Light | All connections secure.
```

---

## 3. 사진 저장 규칙

### 3.1 사진 저장 위치
- 사진은 **엑셀 파일 내부에만 저장**됩니다.
- 각 PNL NO별로 사진이 있는 경우, "Photos" 시트에 저장됩니다.

### 3.2 사진 포함 방식
- 사진은 Base64 인코딩된 이미지 데이터 URL로 "Photos" 시트에 저장됩니다.
- 컬럼 구조:
  - PNL NO.: 분전반 고유 번호
  - 사진 URL/Base64: Base64 인코딩된 이미지 데이터 또는 URL
  - 사진 존재 여부: `Yes` 또는 `No`

### 3.3 로컬 사진 삭제 정책 (옵션 A)
- 엑셀 내보내기 완료 후, 해당 PNL NO의 로컬 사진 데이터는 삭제됩니다.
- 텍스트/숫자 데이터(메모, 차단기 정보 등)는 유지됩니다.
- 사진의 최종 보관처는 엑셀 파일뿐입니다.

---

## 4. 포맷 검증 규칙

### 4.1 필수 검증 항목
1. **시트 존재 여부**: 3개 시트 모두 존재해야 함
2. **헤더 검증**: 각 시트의 첫 번째 행이 정확한 컬럼명을 포함해야 함
3. **데이터 타입 검증**: 각 컬럼의 데이터 타입이 스펙과 일치해야 함
4. **필수 필드 검증**: 필수 필드가 비어있지 않아야 함

### 4.2 포맷 오류 처리
- 스펙과 다른 경우 "포맷 오류" 메시지 표시
- 부분 로드 정책: 가능한 데이터만 로드하고 오류 행은 무시

---

## 5. 버전 관리

### 5.1 포맷 버전 표시
- 메타 시트에 `formatVersion: 1.0` 명시
- 또는 파일명에 버전 포함: `분전함_검사현황_v1.0_2025-01-26.xlsx`

### 5.2 구버전 지원
- 현재 지원 포맷 버전: **1.0**
- 구버전 파일은 "구버전 안내" 메시지 표시 또는 선택적 지원

---

## 6. PC 임포트 규칙

### 6.1 헤더 매핑
- PC 임포트 시 헤더/컬럼명으로 자동 매핑
- 한국어/영어 컬럼명 모두 지원

### 6.2 매핑 우선순위
1. 정확한 컬럼명 일치
2. 부분 문자열 포함 (예: "PNL NO" 포함 시 "PNL NO."로 매핑)
3. 대소문자 무시 매칭

### 6.3 오류 처리
- 스펙과 다른 포맷: "포맷 오류" 메시지 + 무시 또는 부분 로드
- 필수 컬럼 누락: 오류 메시지 표시

---

## 7. 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2025-01-26 | 초기 스펙 작성 |
